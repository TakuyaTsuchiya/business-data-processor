# ガレージバンク新規登録 住所分割修正

## 概要
ガレージバンク新規登録の住所分割処理で、「町田市」など特殊な市名が正しく認識されない問題を修正する。

## 問題の詳細

### 発生した問題
- 入力: `住所_1 = "町田市成瀬が丘1-10-24"`, `住所_2 = "エクセレントハイム102号"`
- 期待される出力:
  - `契約者現住所2`: `町田市`
  - `契約者現住所3`: `成瀬が丘1-10-24　エクセレントハイム102号`
- 実際の出力:
  - `契約者現住所2`: `町田市成瀬が丘1-10-24`
  - `契約者現住所3`: `　エクセレントハイム102号` (先頭に全角スペース)

### 原因
現在の住所分割処理は正規表現ベース:
```python
match = re.match(r'^([^市区町村]+?市)', address)
```
`[^市区町村]` は「市・区・町・村」を含まない文字を意味するため、「町田市」の「町」が除外されてマッチしない。

### 影響を受ける市名
- 「町」を含む: 町田市
- 「市」を含む: 市原市、市川市、四日市市、廿日市市、野々市市
- 「村」を含む: 村上市、村山市、東村山市、武蔵村山市、大村市、田村市、羽村市

## 解決方針
共通の`AddressSplitter`クラス（辞書ベース）を使用する。
- 既にアーク新規登録などで使用されている
- `data/municipalities.json`に全国の市区町村名が登録されている
- 辞書マッチングのため、正規表現の問題は発生しない

## 実装タスク

### 1. テスト追加 (RED)
- [x] 町田市の住所分割テストを追加
- [x] 市原市の住所分割テストを追加
- [x] 東村山市の住所分割テストを追加

### 2. 実装修正 (GREEN)
- [x] `AddressSplitter`をインポート
- [x] `split_address`関数をAddressSplitterベースに変更

### 3. リファクタリング
- [x] 不要になった`DESIGNATED_CITIES`定数を削除
- [x] 不要になった`TOKYO_WARDS`定数を削除
- [x] 正規表現ベースの処理を削除

## 修正対象ファイル
- `processors/gb_registration.py`
- `tests/test_gb_registration.py`

## テスト方法
```bash
python -m pytest tests/test_gb_registration.py -v
```

---
作成日: 2026-01-23
